<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="cs"> <!--<![endif]-->
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>Spořík v0.2</title>
        <link rel="stylesheet" media="all" href="./node_modules/bootstrap/dist/css/bootstrap.min.css" type="text/css" />
        <style>
            .ng-cloak { display:none !important; }
            .panel { 
                padding:0 10px;
             }
             #content { margin-top:20px; }

            .box {
                margin-top:-20px;
            }
        </style>
    </head>
    <body class="container" ng-app="sporikApp" ng-controller="sporikDashboard as main">
        <header class="page-header">
            <div class="box pull-right" ng-if="main.elmer.ok == true">
                <label class="label label-default">P1: {{ main.elmer['P1A+'] / 10 }} W</label><br>
                <label class="label label-default">P2: {{ main.elmer['P2A+'] / 10 }} W</label><br>
                <label class="label label-default">P3: {{ main.elmer['P3A+'] / 10 }} W</label> 
            </div>

            <h1>Spořík v0.2 &nbsp;<span id="loading" ng-show="!main.loaded" class="badge">Loading...</span></h1> 
        </header>

        <div class="row" ng-cloak id="content">
            <div ng-if="main.devices.length == 0" class="alert alert-warning col-md-6 col-md-offset-3">
                Žádné zařízení není připojeno
                <button class="btn btn-outline btn-warning pull-right" ng-click="main.load()">Refresh</button>
            </div>
            <div class="container">
            <div ng-repeat="item in main.devices" class="col-md-4 clearfix panel panel-default" ng-cloak>
                <div class="info">
                {{ item}}
                    <h4>Zařízení: <label>{{ item.address }}</label></h4>
                    <input type="range" min="1" max="8499" ng-model="main.dataValue" ng-change="main.regulate(item.address, main.dataValue)" ng-model-options="{debounce:200}" />
                    {{ main.dataValue }}
                    <br><br>
                    Aktuální spotřeba: <label>{{ item.measurementValue }}W</label>
                    <button ng-click="main.regulate(item.address, main.dataValue)" class="btn pull-right btn-sm">Regulate</button>
                    <button ng-click="main.toggle(item.address)" class="btn pull-right btn-sm btn-outline btn-danger">Toggle</button>
                </div>
                <br style="clear:both">
            </div>
            </div>
        </div>

    </body>
    <script src="./node_modules/angular/angular.js"></script>
    <script src="./main.js"></script>
</html>
